var app=function(){"use strict";return function(){window.dataLayer=window.dataLayer||[],document.addEventListener("submit",(function(e){if(e.target.closest("[data-mailer]")){e.preventDefault(),e.stopPropagation();let t=e.target.closest("form"),a=new FormData(t);const n=sessionStorage.utm?JSON.parse(sessionStorage.utm):{};if(Object.keys(n).forEach((e=>{a.append(`utm_${e}`,n[e])})),a.get("phone")&&"+7 (___) ___-__-__"===a.get("phone"))return;a.append("page_href",window.location.href),a.append("referrer",document.referrer),a.append("date",(new Date).toLocaleString()),t.classList.add("on-request"),fetch("/mailer.php",{method:"POST",body:a}).then((function(e){return e.text()})).then((function(){if(window.dataLayer.push({event:"formSubmission",data:{formId:t.dataset.formId}}),window.dataLayer.push({formId:t.dataset.formId}),e.target.closest("[data-presentation]")){const t=JSON.parse(e.target.closest("[data-presentation]").dataset.presentation);var a=document.createElement("a");a.setAttribute("href",t.href),a.download=t.name,a.click()}else t.dataset.feedbackOff&&"true"===t.dataset.feedbackOff||document.dispatchEvent(new CustomEvent("needModal",{detail:"modal_success"}));t.classList.remove("on-request")}))}}))}}();