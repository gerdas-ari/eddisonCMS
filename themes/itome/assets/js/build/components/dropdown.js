var app=function(){"use strict";return class{constructor(t){this.ref=t;const e=this.ref.dataset;this.options=JSON.parse(e.dropdownOptions),e.dropdownPlaceholder?this.placeholder=e.dropdownPlaceholder:this.defaultValue=JSON.parse(e.defaultValue),e.dropdownReadonly||(this.readOnly=!1),e.dropdownName?this.name=e.dropdownName:this.name="genericDropdown",this.data={key:"",value:""},this.ref.innerHTML=this.render(),this.visibleInput=this.ref.querySelector("[data-dropdown-input]"),this.hiddenInput=this.ref.querySelector("[data-dropdown-value]"),this.optionsList=this.ref.querySelector("[data-dropdown-list]"),this.optionListRect,this.defaultValue&&this.setOption(this.defaultValue),this.addEventListeners()}render(){return`\n            ${this.renderInputs()}\n            <div class="form__dropdown_arrow" data-dropdown-arrow=""></div>\n            <div class="form__dropdown_menu" data-dropdown-list data-simplebar>\n                ${this.renderOptions()}\n            </div>\n\t\t\t`}renderInputs(){return`\n            <input data-dropdown-input readonly name="${this.name}_visible" ${this.placeholder?'placeholder="'+this.placeholder+'"':""}>\n            <input data-dropdown-value type="hidden" name="${this.name}" value="">\n\t\t\t`}renderOptions(t=this.options){return t.reduce(((t,e)=>t+`<button type="button" data-dropdown-option data-dropdown-value="${e.value}">${e.key}</button>`),"")}addEventListeners(){document.addEventListener("click",(({target:t})=>{t.closest("[data-dropdown]")||this.handleInputBlur()})),this.ref.addEventListener("click",this.handleClick.bind(this)),this.optionsList.addEventListener("mousedown",this.handleOptionClick.bind(this))}handleInputFocus(){this.ref.classList.add("on-focus"),this.readOnly||(this.visibleInput.placeholder="Поиск по названию",this.visibleInput.value=""),document.dispatchEvent(new CustomEvent("dropdown::gotFocus",{detail:{el:this.ref}}))}handleInputBlur(){this.ref.classList.remove("on-focus"),this.visibleInput.placeholder=this.placeholder,this.visibleInput.value=this.data.key,document.dispatchEvent(new CustomEvent("dropdown::lostFocus",{detail:{el:this.ref}}))}handleOptionClick({target:t}){const e=t.closest("[data-dropdown-option]");this.setOption({key:e.innerText,value:e.dataset.dropdownValue})}handleClick(){this.optionListRect=this.optionsList.getBoundingClientRect(),this.ref.classList.toggle("on-focus")}setOption({key:t,value:e}){this.visibleInput.value=t,this.visibleInput.classList.add("is-value"),this.hiddenInput.value=e,this.data={key:t,value:e},document.dispatchEvent(new CustomEvent("dropdown::optionSet",{detail:{el:this.ref,data:this.data}})),document.dispatchEvent(new CustomEvent("dropdown::change",{detail:{input:this.hiddenInput}}))}handleInputInput({target:t}){const e=this.filterOptions(t.value);e.length?this.optionsList.innerHTML=this.renderOptions(e):this.optionsList.innerHTML='<div data-dropdown-option class="is-disabled">Ничего не найдено</div>'}filterOptions(t){return this.options.filter((e=>~e.key.toLowerCase().indexOf(t.toLowerCase())))}}}();